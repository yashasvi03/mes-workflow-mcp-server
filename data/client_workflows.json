{
  "Demo Pharma": {
    "last_generated": "2025-10-14T17:27:47.786Z",
    "stage": "All",
    "version": 2,
    "mermaid_code": "%%{init: {'theme':'base', 'themeVariables': { 'primaryColor':'#e1f5ff','primaryTextColor':'#01579b','primaryBorderColor':'#0288d1','lineColor':'#546e7a','secondaryColor':'#fff9e1','tertiaryColor':'#f3e5f5'}}}%%\ngraph TB\n  classDef macroStyle fill:#0288d1,stroke:#01579b,stroke-width:4px,color:#ffffff,font-weight:bold,font-size:16px\n  classDef microStyle fill:#fff9e1,stroke:#f9a825,stroke-width:2px,color:#3e2723,font-size:14px\n  classDef loopStyle fill:#8e24aa,stroke:#4a148c,stroke-width:3px,color:#ffffff,font-weight:bold,font-size:14px\n  classDef exceptionStyle fill:#ffcdd2,stroke:#c62828,stroke-width:3px,stroke-dasharray:8 4,color:#b71c1c,font-weight:bold\n  classDef decisionStyle fill:#fff3e0,stroke:#e65100,stroke-width:3px,color:#e65100,font-weight:bold\n  classDef convergeStyle fill:#c8e6c9,stroke:#2e7d32,stroke-width:3px,color:#1b5e20,font-weight:bold\n  classDef dualPathStyle fill:#e1bee7,stroke:#6a1b9a,stroke-width:3px,color:#4a148c,font-weight:bold\n\n  %% ========================================\n  %% START\n  %% ========================================\n\n  START([üèÅ START DISPENSING])\n  style START fill:#4caf50,stroke:#2e7d32,stroke-width:4px,color:#ffffff,font-weight:bold,font-size:18px\n\n  %% ========================================\n  %% STAGE 1: PRE-DISPENSING\n  %% ========================================\n\n  M1[\"üìã PRE-DISPENSING &<br/>ROOM READINESS\"]\n  class M1 macroStyle\n  START --> M1\n\n  %% ========================================\n  %% STAGE 2: MATERIAL ALLOCATION\n  %% ========================================\n\n  M2[\"üì¶ MATERIAL IDENTIFICATION<br/>ALLOCATION & STAGING\"]\n  class M2 macroStyle\n  M1 ==> M2\n\n  T014[\"üéØ SAP/ERP BATCH<br/>DETERMINATION\"]\n  style T014 fill:#bbdefb,stroke:#1565c0,stroke-width:3px,color:#0d47a1,font-weight:bold\n\n  %% ========================================\n  %% STAGE 3: WEIGHING & DISPENSING\n  %% ========================================\n\n  M3[\"‚öñÔ∏è WEIGHING &<br/>DISPENSING\"]\n  class M3 macroStyle\n  M2 ==> M3\n\n  ROUTE{\"üîÄ CONTAINER<br/>SEALED?<br/>(Material-Dependent)\"}\n  class ROUTE dualPathStyle\n  M3 --> ROUTE\n\n  %% ========================================\n  %% STAGE 4: LABELING & DOCUMENTATION\n  %% ========================================\n\n  M5[\"üè∑Ô∏è LABELING, RECONCILIATION<br/>& DOCUMENTATION\"]\n  class M5 macroStyle\n\n  CONVERGE[\"üîó PATHS CONVERGE\"]\n  class CONVERGE convergeStyle\n  CONVERGE ==> M5\n\n  %% ========================================\n  %% STAGE 5: POST-DISPENSING\n  %% ========================================\n\n  M6[\"üì§ POST-DISPENSING<br/>TRANSFER & ERP POSTING\"]\n  class M6 macroStyle\n  M5 ==> M6\n\n  %% ========================================\n  %% END\n  %% ========================================\n\n  COMPLETE([üéâ DISPENSING COMPLETE])\n  style COMPLETE fill:#4caf50,stroke:#2e7d32,stroke-width:4px,color:#ffffff,font-weight:bold,font-size:18px\n  M6 ==> COMPLETE\n\n  subgraph Pre-Dispensing[\"Pre-Dispensing\"]\n    DISP_M_001[[\"DISP-M-001:<br/>Pre-Dispensing & Room Readiness\"]]\n    class DISP_M_001 macroStyle\n    DISP_001[\"DISP-001:<br/>Training & role gate\"]\n    class DISP_001 microStyle\n    DISP_002[\"DISP-002:<br/>Line clearance request & checklist\"]\n    class DISP_002 microStyle\n    DISP_003[\"DISP-003:<br/>Verify previous batch clearance and remove residuals\"]\n    class DISP_003 microStyle\n    DISP_004[\"DISP-004:<br/>Check room cleaning hold-time validity\"]\n    class DISP_004 microStyle\n    DISP_005[\"DISP-005:<br/>If cleaning hold-time expired, perform cleaning & record\"]\n    class DISP_005 exceptionStyle\n    DISP_006[\"DISP-006:<br/>Capture RT/RH/DP (auto/manual) & evaluate limits\"]\n    class DISP_006 microStyle\n    DISP_008[\"DISP-008:<br/>Balance calibration/verification validity check\"]\n    class DISP_008 microStyle\n    DISP_009[\"DISP-009:<br/>QA room readiness inspection & e-sign\"]\n    class DISP_009 microStyle\n  end\n  subgraph Material_Allocation[\"Material Allocation\"]\n    DISP_M_002[[\"DISP-M-002:<br/>Material Identification, Allocation & Staging\"]]\n    class DISP_M_002 macroStyle\n    DISP_010[\"DISP-010:<br/>Retrieve production order & BOM\"]\n    class DISP_010 microStyle\n    DISP_011[\"DISP-011:<br/>Sync material master (expiry, storage, status, TOR rules)\"]\n    class DISP_011 microStyle\n    DISP_012[\"DISP-012:<br/>Fetch available inventory lots\"]\n    class DISP_012 microStyle\n    DISP_013[\"DISP-013:<br/>Filter lots by allowed status and re-test validity\"]\n    class DISP_013 microStyle\n    DISP_014[\"DISP-014:<br/>ERP batch/lot determination (if configured)\"]\n    class DISP_014 microStyle\n    DISP_016[\"DISP-016:<br/>Reserve lots; stage to dispensing area; verify mapping\"]\n    class DISP_016 microStyle\n    DISP_017[\"DISP-017:<br/>Identify container and verify against allocation\"]\n    class DISP_017 microStyle\n  end\n  subgraph Weighing_and_Dispensing[\"Weighing & Dispensing\"]\n    DISP_M_003[[\"DISP-M-003:<br/>Container-by-Container Dispensing (Weighing Path)\"]]\n    class DISP_M_003 macroStyle\n    DISP_M_004[[\"DISP-M-004:<br/>Sealed Container Dispensing (No-Weigh Path)\"]]\n    class DISP_M_004 macroStyle\n    DISP_L_001((\"DISP-L-001:<br/>Start container loop (weighing)\"))\n    class DISP_L_001 loopStyle\n    DISP_020[\"DISP-020:<br/>Select next container for weighing\"]\n    class DISP_020 microStyle\n    DISP_021[\"DISP-021:<br/>Check container integrity (seal/label)\"]\n    class DISP_021 exceptionStyle\n    DISP_022[\"DISP-022:<br/>Balance suitability vs target band\"]\n    class DISP_022 microStyle\n    DISP_023[\"DISP-023:<br/>Select weighing method for this container\"]\n    class DISP_023 microStyle\n    DISP_024[\"DISP-024:<br/>Tare container / record empty weight\"]\n    class DISP_024 microStyle\n    DISP_025[\"DISP-025:<br/>Pull assay & CoA; compute adjusted quantity\"]\n    class DISP_025 microStyle\n    DISP_026[\"DISP-026:<br/>Apply UoM conversion & rounding\"]\n    class DISP_026 microStyle\n    DISP_026A[\"DISP-026A:<br/>Instrument handshake health check\"]\n    class DISP_026A microStyle\n    DISP_027[\"DISP-027:<br/>Weigh material into dispense container\"]\n    class DISP_027 microStyle\n    DISP_027S[\"DISP-027S:<br/>Spill detection gate\"]\n    class DISP_027S exceptionStyle\n    DISP_027C[\"DISP-027C:<br/>Spill cleanup per SOP and waste logging\"]\n    class DISP_027C microStyle\n    DISP_027A[\"DISP-027A:<br/>Adjust inventory and re-weigh delta (if continuing)\"]\n    class DISP_027A microStyle\n    DISP_028[\"DISP-028:<br/>Network fallback capture (manual entry + photo)\"]\n    class DISP_028 exceptionStyle\n    DISP_029[\"DISP-029:<br/>Check tolerance; deviation per policy if OOT\"]\n    class DISP_029 exceptionStyle\n    DISP_030[\"DISP-030:<br/>Print & affix container label; scan verify\"]\n    class DISP_030 microStyle\n    DISP_030V[\"DISP-030V:<br/>Label scanback verification (uniqueness & match)\"]\n    class DISP_030V microStyle\n    DISP_030O[\"DISP-030O:<br/>Offline label issuance with manual template and QA countersign\"]\n    class DISP_030O exceptionStyle\n    DISP_031[\"DISP-031:<br/>Update running total; continue or finish\"]\n    class DISP_031 microStyle\n    DISP_032[\"DISP-032:<br/>Handle last-container partial use (remnant label)\"]\n    class DISP_032 exceptionStyle\n    DISP_L_002((\"DISP-L-002:<br/>End container loop (weighing)\"))\n    class DISP_L_002 loopStyle\n    DISP_SL_001((\"DISP-SL-001:<br/>Start container loop (sealed, no weigh)\"))\n    class DISP_SL_001 loopStyle\n    DISP_SL_002[\"DISP-SL-002:<br/>Scan sealed container; capture declared net mass from label\"]\n    class DISP_SL_002 microStyle\n    DISP_SL_003[\"DISP-SL-003:<br/>Verify container integrity & eligibility (status/retest)\"]\n    class DISP_SL_003 microStyle\n    DISP_SL_004[\"DISP-SL-004:<br/>Print & affix dispensed container label (sealed)\"]\n    class DISP_SL_004 microStyle\n    DISP_SL_005[\"DISP-SL-005:<br/>Update running total; continue or finish\"]\n    class DISP_SL_005 microStyle\n    DISP_SL_006((\"DISP-SL-006:<br/>End container loop (sealed)\"))\n    class DISP_SL_006 loopStyle\n  end\n  subgraph Labeling_and_Documentation[\"Labeling & Documentation\"]\n    DISP_M_005[[\"DISP-M-005:<br/>Labeling, Reconciliation & Documentation\"]]\n    class DISP_M_005 macroStyle\n    DISP_040[\"DISP-040:<br/>Label preview & content validation\"]\n    class DISP_040 microStyle\n    DISP_042[\"DISP-042:<br/>Print & affix aggregate/kit label (if required)\"]\n    class DISP_042 microStyle\n    DISP_042V[\"DISP-042V:<br/>Aggregate/kit label scanback verification\"]\n    class DISP_042V microStyle\n    DISP_044[\"DISP-044:<br/>Label reconciliation (printed vs used vs voided)\"]\n    class DISP_044 microStyle\n  end\n  subgraph Post-Dispensing[\"Post-Dispensing\"]\n    DISP_M_006[[\"DISP-M-006:<br/>Post-Dispensing Transfer, TOR & ERP Posting\"]]\n    class DISP_M_006 macroStyle\n    DISP_050[\"DISP-050:<br/>Assign storage/transfer location & initiate move\"]\n    class DISP_050 microStyle\n    DISP_051[\"DISP-051:<br/>Handover scan at receiving area (chain-of-custody)\"]\n    class DISP_051 microStyle\n    DISP_052A[\"DISP-052A:<br/>ERP GI posting acknowledgement check and retry queue\"]\n    class DISP_052A microStyle\n    DISP_053[\"DISP-053:<br/>Variance reconciliation against BOM and policy\"]\n    class DISP_053 microStyle\n    DISP_054[\"DISP-054:<br/>Close deviations/exceptions & attach evidence\"]\n    class DISP_054 microStyle\n    DISP_055[\"DISP-055:<br/>Archive logs (CoA, WB slips, TOR) & finalize record\"]\n    class DISP_055 microStyle\n  end\n  DISP_017 --> DEC_C_SEC_01\n  DEC_C_SEC_01 -->|Yes ‚Üí Sealed| DISP_SL_001\n  DEC_C_SEC_01 -->|No ‚Üí Weighing| DISP_L_001\n  DISP_M_001 --> DISP_M_002\n  DISP_M_002 --> DISP_M_003\n  DISP_M_002 --> DISP_M_004\n  DISP_M_003 --> DISP_M_005\n  DISP_M_004 --> DISP_M_005\n  DISP_M_005 --> DISP_M_006\n  DISP_001 --> DISP_002\n  DISP_002 --> DISP_003\n  DISP_003 --> DEC_DISP_004\n  DEC_DISP_004 -->|Yes| DISP_004\n  DISP_004 --> DEC_DISP_005\n  DEC_DISP_005 -.->|No ‚Üí Trigger cleaning| DISP_005\n  DISP_003 --> DISP_006\n  DISP_003 --> DEC_DISP_008\n  DEC_DISP_008 -->|Yes| DISP_008\n  DISP_004 --> DISP_009\n  DISP_006 --> DISP_009\n  DISP_008 --> DISP_009\n  DISP_M_001 --> DISP_010\n  DISP_010 --> DISP_011\n  DISP_011 --> DISP_012\n  DISP_012 --> DISP_013\n  DISP_013 --> DISP_014\n  DISP_014 --> DISP_016\n  DISP_016 --> DEC_DISP_017\n  DEC_DISP_017 -->|Yes| DISP_017\n  DISP_L_001 --> DISP_020\n  DISP_020 --> DEC_DISP_021\n  DEC_DISP_021 -.->|Yes ‚Üí Quarantine| DISP_021\n  DISP_020 --> DISP_022\n  DISP_022 --> DISP_023\n  DISP_023 --> DISP_024\n  DISP_024 --> DISP_025\n  DISP_025 --> DISP_026\n  DISP_026 --> DEC_DISP_026A\n  DEC_DISP_026A -->|Yes| DISP_026A\n  DISP_026 --> DEC_DISP_027\n  DEC_DISP_027 -->|Yes| DISP_027\n  DISP_027 --> DEC_DISP_027S\n  DEC_DISP_027S -.->|Yes ‚Üí Spill workflow| DISP_027S\n  DISP_027S --> DISP_027C\n  DISP_027C --> DISP_027A\n  DISP_026 --> DEC_DISP_028\n  DEC_DISP_028 -.->|No ‚Üí Offline capture| DISP_028\n  DISP_027 --> DEC_DISP_029\n  DEC_DISP_029 -.->|No ‚Üí Handle per Q-WB-04| DISP_029\n  DEC_DISP_029 -.->|No ‚Üí Handle per Q-WB-04| DISP_029\n  DISP_027 --> DISP_030\n  DISP_030 --> DEC_DISP_030V\n  DEC_DISP_030V -->|Yes| DISP_030V\n  DISP_030 --> DEC_DISP_030O\n  DEC_DISP_030O -.->|No ‚Üí Offline capture| DISP_030O\n  DISP_030 --> DISP_031\n  DISP_031 -.->|exception| DISP_032\n  DISP_031 --> DISP_L_002\n  DISP_L_002 -.->|Target not reached| DISP_020\n  DISP_SL_001 --> DISP_SL_002\n  DISP_SL_002 --> DEC_DISP_SL_003\n  DEC_DISP_SL_003 -->|Yes| DISP_SL_003\n  DISP_SL_003 --> DISP_SL_004\n  DISP_SL_004 --> DISP_SL_005\n  DISP_SL_005 --> DISP_SL_006\n  DISP_SL_006 -.->|Target not reached| DISP_SL_002\n  DISP_L_002 --> DISP_040\n  DISP_SL_006 --> DISP_040\n  DISP_040 --> DISP_042\n  DISP_042 --> DEC_DISP_042V\n  DEC_DISP_042V -->|Yes| DISP_042V\n  DISP_042 --> DISP_044\n  DISP_044 --> DISP_050\n  DISP_050 --> DISP_051\n  DISP_051 --> DEC_DISP_052A\n  DEC_DISP_052A -->|Yes| DISP_052A\n  DISP_051 --> DISP_053\n  DISP_053 --> DISP_054\n  DISP_054 --> DISP_055\n",
    "metadata": {
      "task_count": 58,
      "decision_count": 28,
      "macro_count": 6,
      "loop_count": 4
    }
  }
}